/*!
 * Cropper v0.11.0
 * https://github.com/fengyuanchen/cropper
 *
 * Copyright (c) 2014-2015 Fengyuan Chen and contributors
 * Released under the MIT license
 *
 * Date: 2015-08-10T12:41:42.192Z
 */
!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t("object"==typeof exports?require("jquery"):jQuery)}(function(t){"use strict";function i(t){return"number"==typeof t&&!isNaN(t)}function e(t){return"undefined"==typeof t}function h(t,e){var h=[];return i(e)&&h.push(e),h.slice.apply(t,h)}function o(t,i){var e=h(arguments,2);return function(){return t.apply(i,e.concat(h(arguments)))}}function s(t){var i=t.match(/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i);return i&&(i[1]!==g.protocol||i[2]!==g.hostname||i[3]!==g.port)}function a(t){var i="timestamp="+(new Date).getTime();return t+(-1===t.indexOf("?")?"?":"&")+i}function n(t){var e=[],h=t.rotate,o=t.scaleX,s=t.scaleY;return i(h)&&e.push("rotate("+h+"deg)"),i(o)&&i(s)&&e.push("scale("+o+","+s+")"),e.length?e.join(" "):"none"}function r(t,i){var e,h,o=it(t.degree)%180,s=(o>90?180-o:o)*Math.PI/180,a=et(s),n=ht(s),r=t.width,p=t.height,d=t.aspectRatio;return i?(e=r/(n+a/d),h=e/d):(e=r*n+p*a,h=r*a+p*n),{width:e,height:h}}function p(e,h){var o,s,a,n=t("<canvas>")[0],p=n.getContext("2d"),d=0,c=0,l=h.naturalWidth,g=h.naturalHeight,u=h.rotate,m=h.scaleX,f=h.scaleY,v=i(m)&&i(f)&&(1!==m||1!==f),x=i(u)&&0!==u,w=x||v,b=l,C=g;return v&&(o=l/2,s=g/2),x&&(a=r({width:l,height:g,degree:u}),b=a.width,C=a.height,o=a.width/2,s=a.height/2),n.width=b,n.height=C,w&&(d=-l/2,c=-g/2,p.save(),p.translate(o,s)),x&&p.rotate(u*Math.PI/180),v&&p.scale(m,f),p.drawImage(e,d,c,l,g),w&&p.restore(),n}function d(i,e){this.$element=t(i),this.options=t.extend({},d.DEFAULTS,t.isPlainObject(e)&&e),this.ready=!1,this.built=!1,this.rotated=!1,this.cropped=!1,this.disabled=!1,this.replaced=!1,this.isImg=!1,this.originalUrl="",this.canvas=null,this.cropBox=null,this.init()}var c=t(window),l=t(document),g=window.location,u="cropper",m="preview."+u,f="cropper-modal",v="cropper-hide",x="cropper-hidden",w="cropper-invisible",b="cropper-move",C="cropper-crop",y="cropper-disabled",B="cropper-bg",$="mousedown touchstart pointerdown MSPointerDown",D="mousemove touchmove pointermove MSPointerMove",W="mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",T="wheel mousewheel DOMMouseScroll",H="dblclick",k="resize."+u,L="build."+u,M="built."+u,Y="cropstart."+u,X="cropmove."+u,R="cropend."+u,z="crop."+u,E="zoom."+u,F=/^(e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/,P="e",I="w",O="s",S="n",j="se",A="sw",U="ne",Z="nw",_="all",q="crop",N="move",K="zoom",Q="none",G=t.isFunction(t("<canvas>")[0].getContext),J=Math.sqrt,V=Math.min,tt=Math.max,it=Math.abs,et=Math.sin,ht=Math.cos,ot=parseFloat,st={};t.extend(st,{init:function(){var t,i=this.$element;if(i.is("img")){if(this.isImg=!0,this.originalUrl=t=i.attr("src"),!t)return;t=i.prop("src")}else i.is("canvas")&&G&&(t=i[0].toDataURL());this.load(t)},trigger:function(i,e){var h=t.Event(i,e);return this.$element.trigger(h),h.isDefaultPrevented()},load:function(i){var e,h,o=this.options,n=this.$element,r="";i&&(n.one(L,o.build),this.trigger(L)||(o.checkImageOrigin&&s(i)&&(r=' crossOrigin="anonymous"',n.prop("crossOrigin")||(e=a(i))),this.$clone=h=t("<img"+r+' src="'+(e||i)+'">'),h.one("load",t.proxy(function(){var t=h[0],e=t.naturalWidth||t.width,o=t.naturalHeight||t.height;this.image={naturalWidth:e,naturalHeight:o,aspectRatio:e/o},this.url=i,this.ready=!0,this.build()},this)).one("error",function(){h.remove()}),h.addClass(v).insertAfter(n)))}}),t.extend(st,{build:function(){var i,e,h,o=this.options,s=this.$element,a=this.$clone;this.ready&&(this.built&&this.unbuild(),this.$cropper=i=t(d.TEMPLATE),s.addClass(x),a.removeClass(v),this.$container=s.parent().append(i),this.$canvas=i.find(".cropper-canvas").append(a),this.$dragBox=i.find(".cropper-drag-box"),this.$cropBox=e=i.find(".cropper-crop-box"),this.$viewBox=i.find(".cropper-view-box"),this.$face=h=e.find(".cropper-face"),this.initPreview(),this.bind(),o.aspectRatio=ot(o.aspectRatio)||0/0,o.autoCrop?(this.cropped=!0,o.modal&&this.$dragBox.addClass(f)):e.addClass(x),o.guides||e.find(".cropper-dashed").addClass(x),o.center||e.find(".cropper-center").addClass(x),o.cropBoxMovable&&h.addClass(b).data("action",_),o.highlight||h.addClass(w),o.background&&i.addClass(B),o.cropBoxResizable||e.find(".cropper-line, .cropper-point").addClass(x),this.setDragMode(o.dragCrop?q:o.movable?N:Q),this.built=!0,this.render(),this.setData(o.data),s.one(M,o.built),this.trigger(M))},unbuild:function(){this.built&&(this.built=!1,this.initialImage=null,this.initialCanvas=null,this.initialCropBox=null,this.container=null,this.canvas=null,this.cropBox=null,this.unbind(),this.resetPreview(),this.$preview=null,this.$viewBox=null,this.$cropBox=null,this.$dragBox=null,this.$canvas=null,this.$container=null,this.$cropper.remove(),this.$cropper=null)}}),t.extend(st,{render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var t=this.options,i=this.$element,e=this.$container,h=this.$cropper;h.addClass(x),i.removeClass(x),h.css(this.container={width:tt(e.width(),ot(t.minContainerWidth)||200),height:tt(e.height(),ot(t.minContainerHeight)||100)}),i.addClass(x),h.removeClass(x)},initCanvas:function(){var i=this.container,e=i.width,h=i.height,o=this.image,s=o.aspectRatio,a={aspectRatio:s,width:e,height:h};h*s>e?a.height=e/s:a.width=h*s,a.oldLeft=a.left=(e-a.width)/2,a.oldTop=a.top=(h-a.height)/2,this.canvas=a,this.limitCanvas(!0,!0),this.initialImage=t.extend({},o),this.initialCanvas=t.extend({},a)},limitCanvas:function(i,e){var h,o,s=this.options,a=s.strict,n=this.container,r=n.width,p=n.height,d=this.canvas,c=d.aspectRatio,l=this.cropBox,g=this.cropped&&l,u=this.initialCanvas||d,m=u.width,f=u.height;i&&(h=ot(s.minCanvasWidth)||0,o=ot(s.minCanvasHeight)||0,h?(a&&(h=tt(g?l.width:m,h)),o=h/c):o?(a&&(o=tt(g?l.height:f,o)),h=o*c):a&&(g?(h=l.width,o=l.height,o*c>h?h=o*c:o=h/c):(h=m,o=f)),t.extend(d,{minWidth:h,minHeight:o,maxWidth:1/0,maxHeight:1/0})),e&&(a?g?(d.minLeft=V(l.left,l.left+l.width-d.width),d.minTop=V(l.top,l.top+l.height-d.height),d.maxLeft=l.left,d.maxTop=l.top):(d.minLeft=V(0,r-d.width),d.minTop=V(0,p-d.height),d.maxLeft=tt(0,r-d.width),d.maxTop=tt(0,p-d.height)):(d.minLeft=-d.width,d.minTop=-d.height,d.maxLeft=r,d.maxTop=p))},renderCanvas:function(t){var i,e,h=this.options,o=this.canvas,s=this.image;this.rotated&&(this.rotated=!1,e=r({width:s.width,height:s.height,degree:s.rotate}),i=e.width/e.height,i!==o.aspectRatio&&(o.left-=(e.width-o.width)/2,o.top-=(e.height-o.height)/2,o.width=e.width,o.height=e.height,o.aspectRatio=i,this.limitCanvas(!0,!1))),(o.width>o.maxWidth||o.width<o.minWidth)&&(o.left=o.oldLeft),(o.height>o.maxHeight||o.height<o.minHeight)&&(o.top=o.oldTop),o.width=V(tt(o.width,o.minWidth),o.maxWidth),o.height=V(tt(o.height,o.minHeight),o.maxHeight),this.limitCanvas(!1,!0),o.oldLeft=o.left=V(tt(o.left,o.minLeft),o.maxLeft),o.oldTop=o.top=V(tt(o.top,o.minTop),o.maxTop),this.$canvas.css({width:o.width,height:o.height,left:o.left,top:o.top}),this.renderImage(),this.cropped&&h.strict&&this.limitCropBox(!0,!0),t&&this.output()},renderImage:function(i){var e,h=this.canvas,o=this.image;o.rotate&&(e=r({width:h.width,height:h.height,degree:o.rotate,aspectRatio:o.aspectRatio},!0)),t.extend(o,e?{width:e.width,height:e.height,left:(h.width-e.width)/2,top:(h.height-e.height)/2}:{width:h.width,height:h.height,left:0,top:0}),this.$clone.css({width:o.width,height:o.height,marginLeft:o.left,marginTop:o.top,transform:n(o)}),i&&this.output()},initCropBox:function(){var i=this.options,e=this.canvas,h=i.aspectRatio,o=ot(i.autoCropArea)||.8,s={width:e.width,height:e.height};h&&(e.height*h>e.width?s.height=s.width/h:s.width=s.height*h),this.cropBox=s,this.limitCropBox(!0,!0),s.width=V(tt(s.width,s.minWidth),s.maxWidth),s.height=V(tt(s.height,s.minHeight),s.maxHeight),s.width=tt(s.minWidth,s.width*o),s.height=tt(s.minHeight,s.height*o),s.oldLeft=s.left=e.left+(e.width-s.width)/2,s.oldTop=s.top=e.top+(e.height-s.height)/2,this.initialCropBox=t.extend({},s)},limitCropBox:function(t,i){var e,h,o=this.options,s=o.strict,a=this.container,n=a.width,r=a.height,p=this.canvas,d=this.cropBox,c=o.aspectRatio;t&&(e=ot(o.minCropBoxWidth)||0,h=ot(o.minCropBoxHeight)||0,d.minWidth=V(n,e),d.minHeight=V(r,h),d.maxWidth=V(n,s?p.width:n),d.maxHeight=V(r,s?p.height:r),c&&(d.maxHeight*c>d.maxWidth?(d.minHeight=d.minWidth/c,d.maxHeight=d.maxWidth/c):(d.minWidth=d.minHeight*c,d.maxWidth=d.maxHeight*c)),d.minWidth=V(d.maxWidth,d.minWidth),d.minHeight=V(d.maxHeight,d.minHeight)),i&&(s?(d.minLeft=tt(0,p.left),d.minTop=tt(0,p.top),d.maxLeft=V(n,p.left+p.width)-d.width,d.maxTop=V(r,p.top+p.height)-d.height):(d.minLeft=0,d.minTop=0,d.maxLeft=n-d.width,d.maxTop=r-d.height))},renderCropBox:function(){var t=this.options,i=this.container,e=i.width,h=i.height,o=this.cropBox;(o.width>o.maxWidth||o.width<o.minWidth)&&(o.left=o.oldLeft),(o.height>o.maxHeight||o.height<o.minHeight)&&(o.top=o.oldTop),o.width=V(tt(o.width,o.minWidth),o.maxWidth),o.height=V(tt(o.height,o.minHeight),o.maxHeight),this.limitCropBox(!1,!0),o.oldLeft=o.left=V(tt(o.left,o.minLeft),o.maxLeft),o.oldTop=o.top=V(tt(o.top,o.minTop),o.maxTop),t.movable&&t.cropBoxMovable&&this.$face.data("action",o.width===e&&o.height===h?N:_),this.$cropBox.css({width:o.width,height:o.height,left:o.left,top:o.top}),this.cropped&&t.strict&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),this.trigger(z,this.getData())}}),t.extend(st,{initPreview:function(){var i=this.url;this.$preview=t(this.options.preview),this.$viewBox.html('<img src="'+i+'">'),this.$preview.each(function(){var e=t(this);e.data(m,{width:e.width(),height:e.height(),original:e.html()}),e.html('<img src="'+i+'" style="display:block;width:100%;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important">')})},resetPreview:function(){this.$preview.each(function(){var i=t(this);i.html(i.data(m).original).removeData(m)})},preview:function(){var i=this.image,e=this.canvas,h=this.cropBox,o=i.width,s=i.height,a=h.left-e.left-i.left,r=h.top-e.top-i.top;this.cropped&&!this.disabled&&(this.$viewBox.find("img").css({width:o,height:s,marginLeft:-a,marginTop:-r,transform:n(i)}),this.$preview.each(function(){var e=t(this),p=e.data(m),d=p.width/h.width,c=p.width,l=h.height*d;l>p.height&&(d=p.height/h.height,c=h.width*d,l=p.height),e.width(c).height(l).find("img").css({width:o*d,height:s*d,marginLeft:-a*d,marginTop:-r*d,transform:n(i)})}))}}),t.extend(st,{bind:function(){var i=this.options,e=this.$element,h=this.$cropper;t.isFunction(i.cropstart)&&e.on(Y,i.cropstart),t.isFunction(i.cropmove)&&e.on(X,i.cropmove),t.isFunction(i.cropend)&&e.on(R,i.cropend),t.isFunction(i.crop)&&e.on(z,i.crop),t.isFunction(i.zoom)&&e.on(E,i.zoom),h.on($,t.proxy(this.cropStart,this)),i.zoomable&&i.mouseWheelZoom&&h.on(T,t.proxy(this.wheel,this)),i.doubleClickToggle&&h.on(H,t.proxy(this.dblclick,this)),l.on(D,this._cropMove=o(this.cropMove,this)).on(W,this._cropEnd=o(this.cropEnd,this)),i.responsive&&c.on(k,this._resize=o(this.resize,this))},unbind:function(){var i=this.options,e=this.$element,h=this.$cropper;t.isFunction(i.cropstart)&&e.off(Y,i.cropstart),t.isFunction(i.cropmove)&&e.off(X,i.cropmove),t.isFunction(i.cropend)&&e.off(R,i.cropend),t.isFunction(i.crop)&&e.off(z,i.crop),t.isFunction(i.zoom)&&e.off(E,i.zoom),h.off($,this.cropStart),i.zoomable&&i.mouseWheelZoom&&h.off(T,this.wheel),i.doubleClickToggle&&h.off(H,this.dblclick),l.off(D,this._cropMove).off(W,this._cropEnd),i.responsive&&c.off(k,this._resize)}}),t.extend(st,{resize:function(){var i,e,h,o=this.$container,s=this.container;!this.disabled&&s&&(h=o.width()/s.width,(1!==h||o.height()!==s.height)&&(i=this.getCanvasData(),e=this.getCropBoxData(),this.render(),this.setCanvasData(t.each(i,function(t,e){i[t]=e*h})),this.setCropBoxData(t.each(e,function(t,i){e[t]=i*h}))))},dblclick:function(){this.disabled||this.setDragMode(this.$dragBox.hasClass(C)?N:q)},wheel:function(t){var i=t.originalEvent,e=i,h=ot(this.options.wheelZoomRatio)||.1,o=1;this.disabled||(t.preventDefault(),e.deltaY?o=e.deltaY>0?1:-1:e.wheelDelta?o=-e.wheelDelta/120:e.detail&&(o=e.detail>0?1:-1),this.zoom(-o*h,i))},cropStart:function(i){var e,h,o=this.options,s=i.originalEvent,a=s&&s.touches,n=s||i;if(!this.disabled){if(a){if(e=a.length,e>1){if(!o.zoomable||!o.touchDragZoom||2!==e)return;n=a[1],this.startX2=n.pageX,this.startY2=n.pageY,h=K}n=a[0]}if(h=h||t(n.target).data("action"),F.test(h)){if(this.trigger(Y,{originalEvent:s,action:h}))return;i.preventDefault(),this.action=h,this.cropping=!1,this.startX=n.pageX,this.startY=n.pageY,h===q&&(this.cropping=!0,this.$dragBox.addClass(f))}}},cropMove:function(t){var i,e=this.options,h=t.originalEvent,o=h&&h.touches,s=h||t,a=this.action;if(!this.disabled){if(o){if(i=o.length,i>1){if(!e.zoomable||!e.touchDragZoom||2!==i)return;s=o[1],this.endX2=s.pageX,this.endY2=s.pageY}s=o[0]}if(a){if(this.trigger(X,{originalEvent:h,action:a}))return;t.preventDefault(),this.endX=s.pageX,this.endY=s.pageY,this.change(s.shiftKey,a===K?h:null)}}},cropEnd:function(t){var i=t.originalEvent,e=this.action;this.disabled||e&&(t.preventDefault(),this.cropping&&(this.cropping=!1,this.$dragBox.toggleClass(f,this.cropped&&this.options.modal)),this.action="",this.trigger(R,{originalEvent:i,action:e}))}}),t.extend(st,{change:function(t,i){var e,h,o=this.options,s=o.aspectRatio,a=this.action,n=this.container,r=this.canvas,p=this.cropBox,d=p.width,c=p.height,l=p.left,g=p.top,u=l+d,m=g+c,f=0,v=0,w=n.width,b=n.height,C=!0;switch(!s&&t&&(s=d&&c?d/c:1),o.strict&&(f=p.minLeft,v=p.minTop,w=f+V(n.width,r.width),b=v+V(n.height,r.height)),h={x:this.endX-this.startX,y:this.endY-this.startY},s&&(h.X=h.y*s,h.Y=h.x/s),a){case _:l+=h.x,g+=h.y;break;case P:if(h.x>=0&&(u>=w||s&&(v>=g||m>=b))){C=!1;break}d+=h.x,s&&(c=d/s,g-=h.Y/2),0>d&&(a=I,d=0);break;case S:if(h.y<=0&&(v>=g||s&&(f>=l||u>=w))){C=!1;break}c-=h.y,g+=h.y,s&&(d=c*s,l+=h.X/2),0>c&&(a=O,c=0);break;case I:if(h.x<=0&&(f>=l||s&&(v>=g||m>=b))){C=!1;break}d-=h.x,l+=h.x,s&&(c=d/s,g+=h.Y/2),0>d&&(a=P,d=0);break;case O:if(h.y>=0&&(m>=b||s&&(f>=l||u>=w))){C=!1;break}c+=h.y,s&&(d=c*s,l-=h.X/2),0>c&&(a=S,c=0);break;case U:if(s){if(h.y<=0&&(v>=g||u>=w)){C=!1;break}c-=h.y,g+=h.y,d=c*s}else h.x>=0?w>u?d+=h.x:h.y<=0&&v>=g&&(C=!1):d+=h.x,h.y<=0?g>v&&(c-=h.y,g+=h.y):(c-=h.y,g+=h.y);0>d&&0>c?(a=A,c=0,d=0):0>d?(a=Z,d=0):0>c&&(a=j,c=0);break;case Z:if(s){if(h.y<=0&&(v>=g||f>=l)){C=!1;break}c-=h.y,g+=h.y,d=c*s,l+=h.X}else h.x<=0?l>f?(d-=h.x,l+=h.x):h.y<=0&&v>=g&&(C=!1):(d-=h.x,l+=h.x),h.y<=0?g>v&&(c-=h.y,g+=h.y):(c-=h.y,g+=h.y);0>d&&0>c?(a=j,c=0,d=0):0>d?(a=U,d=0):0>c&&(a=A,c=0);break;case A:if(s){if(h.x<=0&&(f>=l||m>=b)){C=!1;break}d-=h.x,l+=h.x,c=d/s}else h.x<=0?l>f?(d-=h.x,l+=h.x):h.y>=0&&m>=b&&(C=!1):(d-=h.x,l+=h.x),h.y>=0?b>m&&(c+=h.y):c+=h.y;0>d&&0>c?(a=U,c=0,d=0):0>d?(a=j,d=0):0>c&&(a=Z,c=0);break;case j:if(s){if(h.x>=0&&(u>=w||m>=b)){C=!1;break}d+=h.x,c=d/s}else h.x>=0?w>u?d+=h.x:h.y>=0&&m>=b&&(C=!1):d+=h.x,h.y>=0?b>m&&(c+=h.y):c+=h.y;0>d&&0>c?(a=Z,c=0,d=0):0>d?(a=A,d=0):0>c&&(a=U,c=0);break;case N:r.left+=h.x,r.top+=h.y,this.renderCanvas(!0),C=!1;break;case K:this.zoom(function(t,i,e,h){var o=J(t*t+i*i),s=J(e*e+h*h);return(s-o)/o}(it(this.startX-this.startX2),it(this.startY-this.startY2),it(this.endX-this.endX2),it(this.endY-this.endY2)),i),this.startX2=this.endX2,this.startY2=this.endY2,C=!1;break;case q:h.x&&h.y&&(e=this.$cropper.offset(),l=this.startX-e.left,g=this.startY-e.top,d=p.minWidth,c=p.minHeight,h.x>0?h.y>0?a=j:(a=U,g-=c):h.y>0?(a=A,l-=d):(a=Z,l-=d,g-=c),this.cropped||(this.cropped=!0,this.$cropBox.removeClass(x)))}C&&(p.width=d,p.height=c,p.left=l,p.top=g,this.action=a,this.renderCropBox()),this.startX=this.endX,this.startY=this.endY}}),t.extend(st,{crop:function(){this.built&&!this.disabled&&(this.cropped||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&this.$dragBox.addClass(f),this.$cropBox.removeClass(x)),this.setCropBoxData(this.initialCropBox))},reset:function(){this.built&&!this.disabled&&(this.image=t.extend({},this.initialImage),this.canvas=t.extend({},this.initialCanvas),this.cropBox=t.extend({},this.initialCropBox),this.renderCanvas(),this.cropped&&this.renderCropBox())},clear:function(){this.cropped&&!this.disabled&&(t.extend(this.cropBox,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(),this.renderCanvas(),this.$dragBox.removeClass(f),this.$cropBox.addClass(x))},replace:function(t){!this.disabled&&t&&(this.isImg&&this.$element.attr("src",t),this.options.data=null,this.load(t))},enable:function(){this.built&&(this.disabled=!1,this.$cropper.removeClass(y))},disable:function(){this.built&&(this.disabled=!0,this.$cropper.addClass(y))},destroy:function(){var t=this.$element;this.ready?(this.isImg&&t.attr("src",this.originalUrl),this.unbuild(),t.removeClass(x)):this.$clone&&this.$clone.remove(),t.removeData(u)},move:function(t,h){var o=this.canvas;e(h)&&(h=t),t=ot(t),h=ot(h),this.built&&!this.disabled&&this.options.movable&&(o.left+=i(t)?t:0,o.top+=i(h)?h:0,this.renderCanvas(!0))},zoom:function(t,i){var e,h,o=this.canvas;if(t=ot(t),t&&this.built&&!this.disabled&&this.options.zoomable){if(this.trigger(E,{originalEvent:i,ratio:t}))return;t=0>t?1/(1-t):1+t,e=o.width*t,h=o.height*t,o.left-=(e-o.width)/2,o.top-=(h-o.height)/2,o.width=e,o.height=h,this.renderCanvas(!0),this.setDragMode(N)}},rotate:function(t){var i=this.image,e=i.rotate||0;t=ot(t)||0,this.built&&!this.disabled&&this.options.rotatable&&(i.rotate=(e+t)%360,this.rotated=!0,this.renderCanvas(!0))},scale:function(t,h){var o=this.image;e(h)&&(h=t),t=ot(t),h=ot(h),this.built&&!this.disabled&&this.options.scalable&&(o.scaleX=i(t)?t:1,o.scaleY=i(h)?h:1,this.renderImage(!0))},getData:function(i){var e,h,o=this.options,s=this.image,a=this.canvas,n=this.cropBox;return this.built&&this.cropped?(h={x:n.left-a.left,y:n.top-a.top,width:n.width,height:n.height},e=s.width/s.naturalWidth,t.each(h,function(t,o){o/=e,h[t]=i?Math.round(o):o})):h={x:0,y:0,width:0,height:0},o.rotatable&&(h.rotate=s.rotate||0),o.scalable&&(h.scaleX=s.scaleX||1,h.scaleY=s.scaleY||1),h},setData:function(e){var h,o=this.image,s=this.canvas,a={};t.isFunction(e)&&(e=e.call(this.$element)),this.built&&!this.disabled&&t.isPlainObject(e)&&(i(e.rotate)&&e.rotate!==o.rotate&&this.options.rotatable&&(o.rotate=e.rotate,this.rotated=!0,this.renderCanvas(!0)),h=o.width/o.naturalWidth,i(e.x)&&(a.left=e.x*h+s.left),i(e.y)&&(a.top=e.y*h+s.top),i(e.width)&&(a.width=e.width*h),i(e.height)&&(a.height=e.height*h),this.setCropBoxData(a))},getContainerData:function(){return this.built?this.container:{}},getImageData:function(){return this.ready?this.image:{}},getCanvasData:function(){var t,i=this.canvas;return this.built&&(t={left:i.left,top:i.top,width:i.width,height:i.height}),t||{}},setCanvasData:function(e){var h=this.canvas,o=h.aspectRatio;t.isFunction(e)&&(e=e.call(this.$element)),this.built&&!this.disabled&&t.isPlainObject(e)&&(i(e.left)&&(h.left=e.left),i(e.top)&&(h.top=e.top),i(e.width)?(h.width=e.width,h.height=e.width/o):i(e.height)&&(h.height=e.height,h.width=e.height*o),this.renderCanvas(!0))},getCropBoxData:function(){var t,i=this.cropBox;return this.built&&this.cropped&&(t={left:i.left,top:i.top,width:i.width,height:i.height}),t||{}},setCropBoxData:function(e){var h,o,s=this.cropBox,a=this.options.aspectRatio;t.isFunction(e)&&(e=e.call(this.$element)),this.built&&this.cropped&&!this.disabled&&t.isPlainObject(e)&&(i(e.left)&&(s.left=e.left),i(e.top)&&(s.top=e.top),i(e.width)&&e.width!==s.width&&(h=!0,s.width=e.width),i(e.height)&&e.height!==s.height&&(o=!0,s.height=e.height),a&&(h?s.height=s.width/a:o&&(s.width=s.height*a)),this.renderCropBox())},getCroppedCanvas:function(i){var e,h,o,s,a,n,r,d,c,l,g;return this.built&&this.cropped&&G?(t.isPlainObject(i)||(i={}),g=this.getData(),e=g.width,h=g.height,d=e/h,t.isPlainObject(i)&&(a=i.width,n=i.height,a?(n=a/d,r=a/e):n&&(a=n*d,r=n/h)),o=a||e,s=n||h,c=t("<canvas>")[0],c.width=o,c.height=s,l=c.getContext("2d"),i.fillColor&&(l.fillStyle=i.fillColor,l.fillRect(0,0,o,s)),l.drawImage.apply(l,function(){var t,i,o,s,a,n,d=p(this.$clone[0],this.image),c=d.width,l=d.height,u=[d],m=g.x,f=g.y;return-e>=m||m>c?m=t=o=a=0:0>=m?(o=-m,m=0,t=a=V(c,e+m)):c>=m&&(o=0,t=a=V(e,c-m)),0>=t||-h>=f||f>l?f=i=s=n=0:0>=f?(s=-f,f=0,i=n=V(l,h+f)):l>=f&&(s=0,i=n=V(h,l-f)),u.push(m,f,t,i),r&&(o*=r,s*=r,a*=r,n*=r),a>0&&n>0&&u.push(o,s,a,n),u}.call(this)),c):void 0},setAspectRatio:function(t){var i=this.options;this.disabled||e(t)||(i.aspectRatio=ot(t)||0/0,this.built&&(this.initCropBox(),this.cropped&&this.renderCropBox()))},setDragMode:function(t){var i,e,h=this.options;this.ready&&!this.disabled&&(i=h.dragCrop&&t===q,e=h.movable&&t===N,t=i||e?t:Q,this.$dragBox.data("action",t).toggleClass(C,i).toggleClass(b,e),h.cropBoxMovable||this.$face.data("action",t).toggleClass(C,i).toggleClass(b,e))}}),t.extend(d.prototype,st),d.DEFAULTS={aspectRatio:0/0,data:null,preview:"",strict:!0,responsive:!0,checkImageOrigin:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,dragCrop:!0,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,mouseWheelZoom:!0,wheelZoomRatio:.1,touchDragZoom:!0,cropBoxMovable:!0,cropBoxResizable:!0,doubleClickToggle:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,build:null,built:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},d.setDefaults=function(i){t.extend(d.DEFAULTS,i)},d.TEMPLATE='<div class="cropper-container"><div class="cropper-canvas"></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-action="e"></span><span class="cropper-line line-n" data-action="n"></span><span class="cropper-line line-w" data-action="w"></span><span class="cropper-line line-s" data-action="s"></span><span class="cropper-point point-e" data-action="e"></span><span class="cropper-point point-n" data-action="n"></span><span class="cropper-point point-w" data-action="w"></span><span class="cropper-point point-s" data-action="s"></span><span class="cropper-point point-ne" data-action="ne"></span><span class="cropper-point point-nw" data-action="nw"></span><span class="cropper-point point-sw" data-action="sw"></span><span class="cropper-point point-se" data-action="se"></span></div></div>',d.other=t.fn.cropper,t.fn.cropper=function(i){var o,s=h(arguments,1);return this.each(function(){var e,h=t(this),a=h.data(u);if(!a){if(/destroy/.test(i))return;h.data(u,a=new d(this,i))}"string"==typeof i&&t.isFunction(e=a[i])&&(o=e.apply(a,s))}),e(o)?this:o},t.fn.cropper.Constructor=d,t.fn.cropper.setDefaults=d.setDefaults,t.fn.cropper.noConflict=function(){return t.fn.cropper=d.other,this}});